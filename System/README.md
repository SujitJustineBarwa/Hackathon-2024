How to get C code from Simulink : https://www.youtube.com/watch?v=LAcnV_5GruY
The STM32 matlab Addon : https://www.st.com/en/development-tools/stm32cubemx.html